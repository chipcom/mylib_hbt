*****  если не переключили драйвер РУС/ЛАТ, а нужна ЛАТ буква (upper)
Function kb_rus_lat(cKey)
Static sa := {{"Й","Q"},;
              {"Ц","W"},;
              {"У","E"},;
              {"К","R"},;
              {"Е","T"},;
              {"Н","Y"},;
              {"Г","U"},;
              {"Ш","I"},;
              {"Щ","O"},;
              {"З","P"},;
              {"Ф","A"},;
              {"Ы","S"},;
              {"В","D"},;
              {"А","F"},;
              {"П","G"},;
              {"Р","H"},;
              {"О","J"},;
              {"Л","K"},;
              {"Д","L"},;
              {"Я","Z"},;
              {"Ч","X"},;
              {"С","C"},;
              {"М","V"},;
              {"И","B"},;
              {"Т","N"},;
              {"Ь","M"}}
Local i
cKey := upper(cKey)
if (i := ascan(sa, {|x| x[1] == cKey } )) > 0
  cKey := sa[i,2]
endif
return cKey
